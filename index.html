<!DOCTYPE html>
<html>
<head>
  <title>Webcam to Clean ASCII</title>
  <style>
    body {
      background: black;
      color: lime;
      font-family: monospace;
      white-space: pre;
    }
    video, canvas {
      display: none;
    }
    pre {
      font-size: 9px;
      line-height: 8px;
    }
    button {
      padding: 8px 12px;
      margin: 10px;
    }
  </style>
</head>
<body>

<video id="video" autoplay></video>
<canvas id="canvas"></canvas>
<button onclick="capture()">ðŸ“¸ Capture Clean ASCII</button>
<pre id="ascii"></pre>

<script>
  const symbols = "1234567890@#$& *+-_";

  const video = document.getElementById('video');
  const canvas = document.getElementById('canvas');
  const ctx = canvas.getContext('2d');
  const ascii = document.getElementById('ascii');

  navigator.mediaDevices.getUserMedia({ video: true })
    .then(stream => video.srcObject = stream)
    .catch(err => console.log("Kamera ditolak bro: " + err));

  function capture() {
    const w = 120;
    const h = 80;
    canvas.width = w;
    canvas.height = h;
    ctx.drawImage(video, 0, 0, w, h);

    // Grayscale
    const imageData = ctx.getImageData(0, 0, w, h);
    const data = imageData.data;
    for (let i = 0; i < data.length; i += 4) {
      const gray = (data[i] + data[i + 1] + data[i + 2]) / 3;
      data[i] = data[i + 1] = data[i + 2] = gray;
    }
    ctx.putImageData(imageData, 0, 0);

    // Convert to ASCII
    let result = '';
    const newData = ctx.getImageData(0, 0, w, h).data;
    for (let y = 0; y < h; y++) {
      for (let x = 0; x < w; x++) {
        const i = (y * w + x) * 4;
        const brightness = newData[i];
        const idx = Math.floor((brightness / 255) * (symbols.length - 1));
        result += symbols[idx];
      }
      result += '\n';
    }
    ascii.textContent = result;
  }
</script>

</body>
</html>
